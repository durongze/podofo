cmake_minimum_required(VERSION 3.14)
project (lua VERSION 0.1.0)

set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=gnu99 -O2 -Wall -Wextra -DLUA_COMPAT_5_3 -DLUA_USE_LINUX")

file(GLOB_RECURSE LUA_SRCS_LIST RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} "${CMAKE_CURRENT_SOURCE_DIR}/src/*.c")
list(REMOVE_ITEM LUA_SRCS_LIST src/lua.c src/luac.c )

add_library(liblua STATIC ${LUA_SRCS_LIST})

add_executable(lua ${LUA_SRCS_LIST} "src/lua.c")
add_executable(luac ${LUA_SRCS_LIST} "src/luac.c")

target_link_libraries(lua PRIVATE m dl)
target_link_libraries(luac PRIVATE m dl)

